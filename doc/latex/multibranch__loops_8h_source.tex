\hypertarget{multibranch__loops_8h_source}{}\section{multibranch\+\_\+loops.\+h}
\label{multibranch__loops_8h_source}\index{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h@{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00002 \textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00003 
00004 \textcolor{preprocessor}{#include <\hyperlink{utils_8h}{ViennaRNA/utils.h}>}
00005 \textcolor{preprocessor}{#include <\hyperlink{data__structures_8h}{ViennaRNA/data\_structures.h}>}
00006 \textcolor{preprocessor}{#include <\hyperlink{params_8h}{ViennaRNA/params.h}>}
00007 
00008 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
00009 \textcolor{preprocessor}{# define INLINE inline}
00010 \textcolor{preprocessor}{#else}
00011 \textcolor{preprocessor}{# define INLINE}
00012 \textcolor{preprocessor}{#endif}
00013 
00042 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem( \textcolor{keywordtype}{int} type,
00043                               \textcolor{keywordtype}{int} si1,
00044                               \textcolor{keywordtype}{int} sj1,
00045                               \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00046 
00053 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} exp\_E\_MLstem(\textcolor{keywordtype}{int} type,
00054                                     \textcolor{keywordtype}{int} si1,
00055                                     \textcolor{keywordtype}{int} sj1,
00056                                     \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P);
00057 
00058 
00059 
00065 \textcolor{keywordtype}{int} \hyperlink{group__loops_ga81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} j, \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00066 
00082 \textcolor{keywordtype}{int}
00083 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00084                 \textcolor{keywordtype}{int} *i,
00085                 \textcolor{keywordtype}{int} *j,
00086                 \textcolor{keywordtype}{int} *k,
00087                 \textcolor{keywordtype}{int} en,
00088                 \textcolor{keywordtype}{int} *component1,
00089                 \textcolor{keywordtype}{int} *component2);
00090 
00091 \textcolor{keywordtype}{int}
00092 vrna\_E\_mb\_loop\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00093                     \textcolor{keywordtype}{int} i,
00094                     \textcolor{keywordtype}{int} j,
00095                     \textcolor{keywordtype}{int} *dmli1,
00096                     \textcolor{keywordtype}{int} *dmli2);
00097 
00098 \textcolor{keywordtype}{int}
00099 \hyperlink{group__loops_ga81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i,
00100                 \textcolor{keywordtype}{int} j,
00101                 \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00102 
00103 \textcolor{keywordtype}{int}
00104 E\_ml\_rightmost\_stem(\textcolor{keywordtype}{int} i,
00105                     \textcolor{keywordtype}{int} j,
00106                     \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00107 
00108 \textcolor{keywordtype}{int}
00109 vrna\_E\_ml\_stems\_fast( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00110                       \textcolor{keywordtype}{int} i,
00111                       \textcolor{keywordtype}{int} j,
00112                       \textcolor{keywordtype}{int} *fmi,
00113                       \textcolor{keywordtype}{int} *dmli);
00114 
00115 
00116 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00117 vrna\_exp\_E\_mb\_loop\_fast( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00118                     \textcolor{keywordtype}{int} i,
00119                     \textcolor{keywordtype}{int} j,
00120                     \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} *qqm1);
00121 
00122 
00123 
00124 \textcolor{comment}{/*}
00125 \textcolor{comment}{#################################}
00126 \textcolor{comment}{# Backtracking functions below  #}
00127 \textcolor{comment}{#################################}
00128 \textcolor{comment}{*/}
00129 
00130 \textcolor{keywordtype}{int}
00131 vrna\_BT\_mb\_loop\_fake( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00132                       \textcolor{keywordtype}{int} *u,
00133                       \textcolor{keywordtype}{int} *i,
00134                       \textcolor{keywordtype}{int} *j,
00135                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00136                       \textcolor{keywordtype}{int} *stack\_count);
00137 
00138 \textcolor{keywordtype}{int}
00139 vrna\_BT\_mb\_loop\_split(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00140                       \textcolor{keywordtype}{int} *i,
00141                       \textcolor{keywordtype}{int} *j,
00142                       \textcolor{keywordtype}{int} *k,
00143                       \textcolor{keywordtype}{int} *l,
00144                       \textcolor{keywordtype}{int} *component1,
00145                       \textcolor{keywordtype}{int} *component2,
00146                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00147                       \textcolor{keywordtype}{int} *stack\_count);
00148 
00149 \textcolor{keywordtype}{int}
00150 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00151                 \textcolor{keywordtype}{int} *i,
00152                 \textcolor{keywordtype}{int} *j,
00153                 \textcolor{keywordtype}{int} *k,
00154                 \textcolor{keywordtype}{int} en,
00155                 \textcolor{keywordtype}{int} *component1,
00156                 \textcolor{keywordtype}{int} *component2);
00157 
00158 \textcolor{comment}{/*}
00159 \textcolor{comment}{########################################}
00160 \textcolor{comment}{# BEGIN OF INLINE FUNCTION DEFINITIONS #}
00161 \textcolor{comment}{########################################}
00162 \textcolor{comment}{*/}
00163 
00164 
00165 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem(\textcolor{keywordtype}{int} type, \textcolor{keywordtype}{int} si1, \textcolor{keywordtype}{int} sj1, \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P)\{
00166   \textcolor{keywordtype}{int} energy = 0;
00167   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00168     energy += P->mismatchM[type][si1][sj1];
00169   \}
00170   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)\{
00171     energy += P->dangle5[type][si1];
00172   \}
00173   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)\{
00174     energy += P->dangle3[type][sj1];
00175   \}
00176 
00177   \textcolor{keywordflow}{if}(type > 2)
00178     energy += P->TerminalAU;
00179 
00180   energy += P->MLintern[type];
00181 
00182   \textcolor{keywordflow}{return} energy;
00183 \}
00184 
00185 
00186 
00187 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00188 exp\_E\_MLstem( \textcolor{keywordtype}{int} type,
00189               \textcolor{keywordtype}{int} si1,
00190               \textcolor{keywordtype}{int} sj1,
00191               \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P)\{
00192 
00193   \textcolor{keywordtype}{double} energy = 1.0;
00194   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00195     energy = P->expmismatchM[type][si1][sj1];
00196   \}
00197   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(si1 >= 0)\{
00198     energy = P->expdangle5[type][si1];
00199   \}
00200   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(sj1 >= 0)\{
00201     energy = P->expdangle3[type][sj1];
00202   \}
00203 
00204   \textcolor{keywordflow}{if}(type > 2)
00205     energy *= P->expTermAU;
00206 
00207   energy *= P->expMLintern[type];
00208   \textcolor{keywordflow}{return} (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})energy;
00209 \}
00210 
00215 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
