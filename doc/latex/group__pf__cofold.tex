\hypertarget{group__pf__cofold}{}\section{Partition Function for two hybridized Sequences}
\label{group__pf__cofold}\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}


Partition Function Cofolding.  


Collaboration diagram for Partition Function for two hybridized Sequences\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{group__pf__cofold}
\end{center}
\end{figure}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{part__func__co_8h}{part\+\_\+func\+\_\+co.\+h}
\begin{DoxyCompactList}\small\item\em Partition function for two R\+NA sequences. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s}
\begin{DoxyCompactList}\small\item\em Data structure returned by \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer()}  \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{More...}\end{DoxyCompactList}\item 
struct \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s}
\begin{DoxyCompactList}\small\item\em Data structure for concentration dependency computations.  \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{More...}\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s} \hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t}\hypertarget{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{}\label{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}

\begin{DoxyCompactList}\small\item\em Typename for the data structure that stores the dimer partition functions, \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s}, as returned by \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer()} \end{DoxyCompactList}\item 
typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s} \hyperlink{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{vrna\+\_\+dimer\+\_\+conc\+\_\+t}\hypertarget{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{}\label{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}

\begin{DoxyCompactList}\small\item\em Typename for the data structure that stores the dimer concentrations, \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s}, as required by vrna\+\_\+pf\+\_\+dimer\+\_\+concentration() \end{DoxyCompactList}\item 
typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s} \hyperlink{group__pf__cofold_ga5445d8d96a40e9e79b1fa5a7f1a6b7ea}{cofoldF}\hypertarget{group__pf__cofold_ga5445d8d96a40e9e79b1fa5a7f1a6b7ea}{}\label{group__pf__cofold_ga5445d8d96a40e9e79b1fa5a7f1a6b7ea}

\begin{DoxyCompactList}\small\item\em Backward compatibility typedef for \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s}. \end{DoxyCompactList}\item 
typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s} \hyperlink{group__pf__cofold_ga46244c7adf5040580291c45b465f4efa}{Conc\+Ent}\hypertarget{group__pf__cofold_ga46244c7adf5040580291c45b465f4efa}{}\label{group__pf__cofold_ga46244c7adf5040580291c45b465f4efa}

\begin{DoxyCompactList}\small\item\em Backward compatibility typedef for \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t} \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, char $\ast$structure)
\begin{DoxyCompactList}\small\item\em Calculate partition function and base pair probabilities of nucleic acid/nucleic acid dimers. \end{DoxyCompactList}\item 
void \hyperlink{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}{vrna\+\_\+pf\+\_\+dimer\+\_\+probs} (double F\+AB, double FA, double FB, \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$pr\+AB, const \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$prA, const \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$prB, int Alength, const \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$exp\+\_\+params)
\begin{DoxyCompactList}\small\item\em Compute Boltzmann probabilities of dimerization without homodimers. \end{DoxyCompactList}\item 
\hyperlink{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{vrna\+\_\+dimer\+\_\+conc\+\_\+t} $\ast$ \hyperlink{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations} (double Fc\+AB, double Fc\+AA, double Fc\+BB, double F\+EA, double F\+EB, const double $\ast$startconc, const \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$exp\+\_\+params)
\begin{DoxyCompactList}\small\item\em Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}{mirnatog}\hypertarget{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}{}\label{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}

\begin{DoxyCompactList}\small\item\em Toggles no intrabp in 2nd mol. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}{F\+\_\+monomer} \mbox{[}2\mbox{]}\hypertarget{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}{}\label{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}

\begin{DoxyCompactList}\small\item\em Free energies of the two monomers. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Partition Function Cofolding. 

To simplify the implementation the partition function computation is done internally in a null model that does not include the duplex initiation energy, i.\+e. the entropic penalty for producing a dimer from two monomers). The resulting free energies and pair probabilities are initially relative to that null model. In a second step the free energies can be corrected to include the dimerization penalty, and the pair probabilities can be divided into the conditional pair probabilities given that a re dimer is formed or not formed. See \cite{bernhart:2006} for further details. 

\subsection{Data Structure Documentation}
\index{vrna\+\_\+dimer\+\_\+pf\+\_\+s@{vrna\+\_\+dimer\+\_\+pf\+\_\+s}}\label{structvrna__dimer__pf__s}
\hypertarget{group__pf__cofold_structvrna__dimer__pf__s}{}
\subsubsection{struct vrna\+\_\+dimer\+\_\+pf\+\_\+s}
Data structure returned by \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer()} \subsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}{F0\+AB}\hypertarget{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}{}\label{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}

\begin{DoxyCompactList}\small\item\em Null model without Duplex\+Init. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}{F\+AB}\hypertarget{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}{}\label{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}

\begin{DoxyCompactList}\small\item\em all states with Duplex\+Init correction \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}{Fc\+AB}\hypertarget{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}{}\label{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}

\begin{DoxyCompactList}\small\item\em true hybrid states only \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}{FA}\hypertarget{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}{}\label{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}

\begin{DoxyCompactList}\small\item\em monomer A \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}{FB}\hypertarget{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}{}\label{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}

\begin{DoxyCompactList}\small\item\em monomer B \end{DoxyCompactList}\end{DoxyCompactItemize}
\index{vrna\+\_\+dimer\+\_\+conc\+\_\+s@{vrna\+\_\+dimer\+\_\+conc\+\_\+s}}\label{structvrna__dimer__conc__s}
\hypertarget{group__pf__cofold_structvrna__dimer__conc__s}{}
\subsubsection{struct vrna\+\_\+dimer\+\_\+conc\+\_\+s}
Data structure for concentration dependency computations. \subsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}{A0}\hypertarget{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}{}\label{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}

\begin{DoxyCompactList}\small\item\em start concentration A \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}{B0}\hypertarget{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}{}\label{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}

\begin{DoxyCompactList}\small\item\em start concentration B \end{DoxyCompactList}\item 
double \hyperlink{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}{A\+Bc}\hypertarget{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}{}\label{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}

\begin{DoxyCompactList}\small\item\em End concentration AB. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer@{vrna\+\_\+pf\+\_\+dimer}}
\index{vrna\+\_\+pf\+\_\+dimer@{vrna\+\_\+pf\+\_\+dimer}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{\texorpdfstring{vrna\+\_\+pf\+\_\+dimer(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, char $\ast$structure)}{vrna_pf_dimer(vrna_fold_compound_t *vc, char *structure)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vrna\+\_\+dimer\+\_\+pf\+\_\+t} vrna\+\_\+pf\+\_\+dimer (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{char $\ast$}]{structure}
\end{DoxyParamCaption}
)}\hypertarget{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{}\label{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Calculate partition function and base pair probabilities of nucleic acid/nucleic acid dimers. 

This is the cofold partition function folding.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__fold__compound_ga6601d994ba32b11511b36f68b08403be}{vrna\+\_\+fold\+\_\+compound()} for how to retrieve the necessary data structure
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em vc} & the fold compound data structure \\
\hline
{\em structure} & Will hold the structure or constraints \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vrna\+\_\+dimer\+\_\+pf\+\_\+t structure containing a set of energies needed for concentration computations. 
\end{DoxyReturn}
\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer\+\_\+probs@{vrna\+\_\+pf\+\_\+dimer\+\_\+probs}}
\index{vrna\+\_\+pf\+\_\+dimer\+\_\+probs@{vrna\+\_\+pf\+\_\+dimer\+\_\+probs}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{\texorpdfstring{vrna\+\_\+pf\+\_\+dimer\+\_\+probs(double F\+A\+B, double F\+A, double F\+B, vrna\+\_\+plist\+\_\+t $\ast$pr\+A\+B, const vrna\+\_\+plist\+\_\+t $\ast$pr\+A, const vrna\+\_\+plist\+\_\+t $\ast$pr\+B, int Alength, const vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$exp\+\_\+params)}{vrna_pf_dimer_probs(double FAB, double FA, double FB, vrna_plist_t *prAB, const vrna_plist_t *prA, const vrna_plist_t *prB, int Alength, const vrna_exp_param_t *exp_params)}}]{\setlength{\rightskip}{0pt plus 5cm}void vrna\+\_\+pf\+\_\+dimer\+\_\+probs (
\begin{DoxyParamCaption}
\item[{double}]{F\+AB, }
\item[{double}]{FA, }
\item[{double}]{FB, }
\item[{{\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{pr\+AB, }
\item[{const {\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{prA, }
\item[{const {\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{prB, }
\item[{int}]{Alength, }
\item[{const {\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{exp\+\_\+params}
\end{DoxyParamCaption}
)}\hypertarget{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}{}\label{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Compute Boltzmann probabilities of dimerization without homodimers. 

Given the pair probabilities and free energies (in the null model) for a dimer AB and the two constituent monomers A and B, compute the conditional pair probabilities given that a dimer AB actually forms. Null model pair probabilities are given as a list as produced by \hyperlink{group__pf__fold_gaa3bf26a0ee2e9f2225afbaee44a37264}{vrna\+\_\+plist\+\_\+from\+\_\+probs()}, the dimer probabilities \textquotesingle{}pr\+AB\textquotesingle{} are modified in place.


\begin{DoxyParams}{Parameters}
{\em F\+AB} & free energy of dimer AB \\
\hline
{\em FA} & free energy of monomer A \\
\hline
{\em FB} & free energy of monomer B \\
\hline
{\em pr\+AB} & pair probabilities for dimer \\
\hline
{\em prA} & pair probabilities monomer \\
\hline
{\em prB} & pair probabilities monomer \\
\hline
{\em Alength} & Length of molecule A \\
\hline
{\em exp\+\_\+params} & The precomputed Boltzmann factors \\
\hline
\end{DoxyParams}
\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations@{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations}}
\index{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations@{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{\texorpdfstring{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations(double Fc\+A\+B, double Fc\+A\+A, double Fc\+B\+B, double F\+E\+A, double F\+E\+B, const double $\ast$startconc, const vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$exp\+\_\+params)}{vrna_pf_dimer_concentrations(double FcAB, double FcAA, double FcBB, double FEA, double FEB, const double *startconc, const vrna_exp_param_t *exp_params)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vrna\+\_\+dimer\+\_\+conc\+\_\+t}$\ast$ vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations (
\begin{DoxyParamCaption}
\item[{double}]{Fc\+AB, }
\item[{double}]{Fc\+AA, }
\item[{double}]{Fc\+BB, }
\item[{double}]{F\+EA, }
\item[{double}]{F\+EB, }
\item[{const double $\ast$}]{startconc, }
\item[{const {\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{exp\+\_\+params}
\end{DoxyParamCaption}
)}\hypertarget{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}{}\label{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers. 

This function takes an array \textquotesingle{}startconc\textquotesingle{} of input concentrations with alternating entries for the initial concentrations of molecules A and B (terminated by two zeroes), then computes the resulting equilibrium concentrations from the free energies for the dimers. Dimer free energies should be the dimer-\/only free energies, i.\+e. the Fc\+AB entries from the \hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t} struct.


\begin{DoxyParams}{Parameters}
{\em Fc\+AB} & Free energy of AB dimer (Fc\+AB entry) \\
\hline
{\em Fc\+AA} & Free energy of AA dimer (Fc\+AB entry) \\
\hline
{\em Fc\+BB} & Free energy of BB dimer (Fc\+AB entry) \\
\hline
{\em F\+EA} & Free energy of monomer A \\
\hline
{\em F\+EB} & Free energy of monomer B \\
\hline
{\em startconc} & List of start concentrations \mbox{[}a0\mbox{]},\mbox{[}b0\mbox{]},\mbox{[}a1\mbox{]},\mbox{[}b1\mbox{]},...,\mbox{[}an\mbox{]}\mbox{[}bn\mbox{]},\mbox{[}0\mbox{]},\mbox{[}0\mbox{]} \\
\hline
{\em exp\+\_\+params} & The precomputed Boltzmann factors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vrna\+\_\+dimer\+\_\+conc\+\_\+t array containing the equilibrium energies and start concentrations 
\end{DoxyReturn}
