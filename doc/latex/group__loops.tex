\hypertarget{group__loops}{}\section{Processing and Evaluating Decomposed Loops}
\label{group__loops}\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{exterior__loops_8h}{exterior\+\_\+loops.\+h}
\begin{DoxyCompactList}\small\item\em Energy evaluation of exterior loops for M\+FE and partition function calculations. \end{DoxyCompactList}\item 
file \hyperlink{gquad_8h}{gquad.\+h}
\begin{DoxyCompactList}\small\item\em Various functions related to G-\/quadruplex computations. \end{DoxyCompactList}\item 
file \hyperlink{hairpin__loops_8h}{hairpin\+\_\+loops.\+h}
\begin{DoxyCompactList}\small\item\em Energy evaluation of hairpin loops for M\+FE and partition function calculations. \end{DoxyCompactList}\item 
file \hyperlink{interior__loops_8h}{interior\+\_\+loops.\+h}
\begin{DoxyCompactList}\small\item\em Energy evaluation of interior loops for M\+FE and partition function calculations. \end{DoxyCompactList}\item 
file \hyperlink{loop__energies_8h}{loop\+\_\+energies.\+h}
\begin{DoxyCompactList}\small\item\em Energy evaluation for M\+FE and partition function calculations. \end{DoxyCompactList}\item 
file \hyperlink{multibranch__loops_8h}{multibranch\+\_\+loops.\+h}
\begin{DoxyCompactList}\small\item\em Energy evaluation of multibranch loops for M\+FE and partition function calculations. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}{E\+\_\+\+Ext\+Loop} (int type, int si1, int sj1, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\item 
\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} \hyperlink{group__loops_ga446828a191c127861e76e2c84055f672}{exp\+\_\+\+E\+\_\+\+Ext\+Loop} (int type, int si1, int sj1, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$P)
\item 
int \hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem} (int type, int si1, int sj1, int ext\+Loop, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\item 
\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} \hyperlink{group__loops_gab0aa9833ab41875a91a9be8a5ffd7092}{exp\+\_\+\+E\+\_\+\+Stem} (int type, int si1, int sj1, int ext\+Loop, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$P)
\item 
int $\ast$ \hyperlink{group__loops_ga392e45c9615aa123737671603fa4203c}{get\+\_\+gquad\+\_\+matrix} (short $\ast$S, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\begin{DoxyCompactList}\small\item\em Get a triangular matrix prefilled with minimum free energy contributions of G-\/quadruplexes. \end{DoxyCompactList}\item 
int \hyperlink{group__loops_gae41763215b9c64d2a7b67f0df8a28078}{parse\+\_\+gquad} (const char $\ast$struc, int $\ast$L, int l\mbox{[}3\mbox{]})
\item 
P\+R\+I\+V\+A\+TE int \hyperlink{group__loops_ga220c41e8dbcee940ac975b8ce88e55c5}{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop} (int c, int i, int j, int type, short $\ast$S, int $\ast$ggg, int $\ast$index, int $\ast$p, int $\ast$q, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\item 
P\+R\+I\+V\+A\+TE int \hyperlink{group__loops_ga7b371308fa5a45c7ac353ef6ed1014de}{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L} (int c, int i, int j, int type, short $\ast$S, int $\ast$$\ast$ggg, int maxdist, int $\ast$p, int $\ast$q, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\item 
P\+R\+I\+V\+A\+TE int \hyperlink{group__loops_gadf943ee9a45b7f4cee9192c06210dace}{E\+\_\+\+Hairpin} (int size, int type, int si1, int sj1, const char $\ast$string, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\begin{DoxyCompactList}\small\item\em Compute the Energy of a hairpin-\/loop. \end{DoxyCompactList}\item 
P\+R\+I\+V\+A\+TE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} \hyperlink{group__loops_ga51fb555974f180b78d76142b2894851c}{exp\+\_\+\+E\+\_\+\+Hairpin} (int u, int type, short si1, short sj1, const char $\ast$string, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$P)
\begin{DoxyCompactList}\small\item\em Compute Boltzmann weight $e^{-\Delta G/kT} $ of a hairpin loop. \end{DoxyCompactList}\item 
int \hyperlink{group__loops_ga999ba163a8148d72fd5f22819a681df7}{vrna\+\_\+\+E\+\_\+hp\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j)
\begin{DoxyCompactList}\small\item\em Evaluate the free energy of a hairpin loop and consider hard constraints if they apply. \end{DoxyCompactList}\item 
int \hyperlink{group__loops_gac3393ee309372eccae944e3a07f455f9}{vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j)
\begin{DoxyCompactList}\small\item\em Evaluate the free energy of an exterior hairpin loop and consider possible hard constraints. \end{DoxyCompactList}\item 
\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} \hyperlink{group__loops_gac9f49b31d3ec1d9040798b05506c71da}{vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j)
\begin{DoxyCompactList}\small\item\em High-\/\+Level function for hairpin loop energy evaluation (partition function variant) \end{DoxyCompactList}\item 
int \hyperlink{group__loops_ga6c4ba14d24f716d0ca9021771357e903}{vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, int en, \hyperlink{group__data__structures_gaa651bda42e7692f08cb603cd6834b0ee}{vrna\+\_\+bp\+\_\+stack\+\_\+t} $\ast$bp\+\_\+stack, int $\ast$stack\+\_\+count)
\begin{DoxyCompactList}\small\item\em Backtrack a hairpin loop closed by $ (i,j) $. \end{DoxyCompactList}\item 
P\+R\+I\+V\+A\+TE int \hyperlink{group__loops_ga0266d2c7a6098259280fb97e9f980b34}{E\+\_\+\+Int\+Loop} (int n1, int n2, int type, int type\+\_\+2, int si1, int sj1, int sp1, int sq1, \hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} $\ast$P)
\item 
P\+R\+I\+V\+A\+TE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} \hyperlink{group__loops_ga19f10a6a02bbd07f4cd27b16ac928ea3}{exp\+\_\+\+E\+\_\+\+Int\+Loop} (int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$P)
\item 
int \hyperlink{group__loops_ga98a95d7a76da898b86e7bf459a062fdd}{E\+\_\+stack} (int i, int j, \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc)\hypertarget{group__loops_ga98a95d7a76da898b86e7bf459a062fdd}{}\label{group__loops_ga98a95d7a76da898b86e7bf459a062fdd}

\begin{DoxyCompactList}\small\item\em Evaluate energy of a base pair stack closed by (i,j) \end{DoxyCompactList}\item 
int \hyperlink{group__loops_gad320d5d721e33bed120168213d8f45e5}{vrna\+\_\+\+B\+T\+\_\+stack} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int $\ast$i, int $\ast$j, int $\ast$en, \hyperlink{group__data__structures_gaa651bda42e7692f08cb603cd6834b0ee}{vrna\+\_\+bp\+\_\+stack\+\_\+t} $\ast$bp\+\_\+stack, int $\ast$stack\+\_\+count)\hypertarget{group__loops_gad320d5d721e33bed120168213d8f45e5}{}\label{group__loops_gad320d5d721e33bed120168213d8f45e5}

\begin{DoxyCompactList}\small\item\em Backtrack a stacked pair closed by $ (i,j) $. \end{DoxyCompactList}\item 
int \hyperlink{group__loops_ga849b7dc373b6c0b029672e16a7e52053}{vrna\+\_\+\+B\+T\+\_\+int\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int $\ast$i, int $\ast$j, int en, \hyperlink{group__data__structures_gaa651bda42e7692f08cb603cd6834b0ee}{vrna\+\_\+bp\+\_\+stack\+\_\+t} $\ast$bp\+\_\+stack, int $\ast$stack\+\_\+count)\hypertarget{group__loops_ga849b7dc373b6c0b029672e16a7e52053}{}\label{group__loops_ga849b7dc373b6c0b029672e16a7e52053}

\begin{DoxyCompactList}\small\item\em Backtrack an interior loop closed by $ (i,j) $. \end{DoxyCompactList}\item 
int \hyperlink{group__loops_ga81d73d23f480f84df8cfd0042c032503}{E\+\_\+mb\+\_\+loop\+\_\+stack} (int i, int j, \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc)
\begin{DoxyCompactList}\small\item\em Evaluate energy of a multi branch helices stacking onto closing pair (i,j) \end{DoxyCompactList}\item 
int \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int $\ast$i, int $\ast$j, int $\ast$k, int en, int $\ast$component1, int $\ast$component2)
\begin{DoxyCompactList}\small\item\em Backtrack the decomposition of a multi branch loop closed by $ (i,j) $. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!E\+\_\+\+Ext\+Loop@{E\+\_\+\+Ext\+Loop}}
\index{E\+\_\+\+Ext\+Loop@{E\+\_\+\+Ext\+Loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{E\+\_\+\+Ext\+Loop(int type, int si1, int sj1, vrna\+\_\+param\+\_\+t $\ast$\+P)}{E_ExtLoop(int type, int si1, int sj1, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}int E\+\_\+\+Ext\+Loop (
\begin{DoxyParamCaption}
\item[{int}]{type, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}{}\label{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}


{\ttfamily \#include $<$\hyperlink{exterior__loops_8h}{Vienna\+R\+N\+A/exterior\+\_\+loops.\+h}$>$}

\subsubsection*{Compute the Energy contribution of an Exterior loop stem}

This definition is a wrapper for the \hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} funtion. It is substituted by an \hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} funtion call with argument ext\+Loop=1, so the energy contribution returned reflects a stem introduced in an exterior-\/loop.~\newline
 As for the parameters si1 and sj1 of the substituted \hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} function, you can inhibit to take 5\textquotesingle{}-\/, 3\textquotesingle{}-\/dangles or mismatch contributions to be taken into account by passing -\/1 to these parameters.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em type} & The pair type of the stem-\/closing pair \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em P} & The datastructure containing scaled energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The energy contribution of the introduced exterior-\/loop stem 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!exp\+\_\+\+E\+\_\+\+Ext\+Loop@{exp\+\_\+\+E\+\_\+\+Ext\+Loop}}
\index{exp\+\_\+\+E\+\_\+\+Ext\+Loop@{exp\+\_\+\+E\+\_\+\+Ext\+Loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{exp\+\_\+\+E\+\_\+\+Ext\+Loop(int type, int si1, int sj1, vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$\+P)}{exp_E_ExtLoop(int type, int si1, int sj1, vrna_exp_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+\+E\+\_\+\+Ext\+Loop (
\begin{DoxyParamCaption}
\item[{int}]{type, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{{\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga446828a191c127861e76e2c84055f672}{}\label{group__loops_ga446828a191c127861e76e2c84055f672}


{\ttfamily \#include $<$\hyperlink{exterior__loops_8h}{Vienna\+R\+N\+A/exterior\+\_\+loops.\+h}$>$}

This is the partition function variant of \hyperlink{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}{E\+\_\+\+Ext\+Loop()} \begin{DoxySeeAlso}{See also}
\hyperlink{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}{E\+\_\+\+Ext\+Loop()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
The Boltzmann weighted energy contribution of the introduced exterior-\/loop stem 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!E\+\_\+\+Stem@{E\+\_\+\+Stem}}
\index{E\+\_\+\+Stem@{E\+\_\+\+Stem}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{E\+\_\+\+Stem(int type, int si1, int sj1, int ext\+Loop, vrna\+\_\+param\+\_\+t $\ast$\+P)}{E_Stem(int type, int si1, int sj1, int extLoop, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}int E\+\_\+\+Stem (
\begin{DoxyParamCaption}
\item[{int}]{type, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{int}]{ext\+Loop, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{}\label{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}


{\ttfamily \#include $<$\hyperlink{exterior__loops_8h}{Vienna\+R\+N\+A/exterior\+\_\+loops.\+h}$>$}

\subsubsection*{Compute the energy contribution of a stem branching off a loop-\/region}

This function computes the energy contribution of a stem that branches off a loop region. This can be the case in multiloops, when a stem branching off increases the degree of the loop but also {\itshape immediately interior base pairs} of an exterior loop contribute free energy. To switch the bahavior of the function according to the evaluation of a multiloop-\/ or exterior-\/loop-\/stem, you pass the flag \textquotesingle{}ext\+Loop\textquotesingle{}. The returned energy contribution consists of a Terminal\+AU penalty if the pair type is greater than 2, dangling end contributions of mismatching nucleotides adjacent to the stem if only one of the si1, sj1 parameters is greater than 0 and mismatch energies if both mismatching nucleotides are positive values. Thus, to avoid incooperating dangling end or mismatch energies just pass a negative number, e.\+g. -\/1 to the mismatch argument.

This is an illustration of how the energy contribution is assembled\+: 
\begin{DoxyPre}
      3'  5'
      |   |
      X - Y
5'-si1     sj1-3'
\end{DoxyPre}


Here, (X,Y) is the base pair that closes the stem that branches off a loop region. The nucleotides si1 and sj1 are the 5\textquotesingle{}-\/ and 3\textquotesingle{}-\/ mismatches, respectively. If the base pair type of (X,Y) is greater than 2 (i.\+e. an A-\/U or G-\/U pair, the Terminal\+AU penalty will be included in the energy contribution returned. If si1 and sj1 are both nonnegative numbers, mismatch energies will also be included. If one of sij or sj1 is a negtive value, only 5\textquotesingle{} or 3\textquotesingle{} dangling end contributions are taken into account. To prohibit any of these mismatch contributions to be incoorporated, just pass a negative number to both, si1 and sj1. In case the argument ext\+Loop is 0, the returned energy contribution also includes the {\itshape internal-\/loop-\/penalty} of a multiloop stem with closing pair type.

\begin{DoxySeeAlso}{See also}
E\+\_\+\+M\+Lstem() 

\hyperlink{group__loops_ga05c6288c5a79d3bd5ad6d33c1bb34bd0}{E\+\_\+\+Ext\+Loop()} 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function is threadsafe
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em type} & The pair type of the first base pair un the stem \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em ext\+Loop} & A flag that indicates whether the contribution reflects the one of an exterior loop or not \\
\hline
{\em P} & The datastructure containing scaled energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Free energy of the branch off the loop in dcal/mol 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!exp\+\_\+\+E\+\_\+\+Stem@{exp\+\_\+\+E\+\_\+\+Stem}}
\index{exp\+\_\+\+E\+\_\+\+Stem@{exp\+\_\+\+E\+\_\+\+Stem}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{exp\+\_\+\+E\+\_\+\+Stem(int type, int si1, int sj1, int ext\+Loop, vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$\+P)}{exp_E_Stem(int type, int si1, int sj1, int extLoop, vrna_exp_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+\+E\+\_\+\+Stem (
\begin{DoxyParamCaption}
\item[{int}]{type, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{int}]{ext\+Loop, }
\item[{{\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_gab0aa9833ab41875a91a9be8a5ffd7092}{}\label{group__loops_gab0aa9833ab41875a91a9be8a5ffd7092}


{\ttfamily \#include $<$\hyperlink{exterior__loops_8h}{Vienna\+R\+N\+A/exterior\+\_\+loops.\+h}$>$}

\subsubsection*{Compute the Boltzmann weighted energy contribution of a stem branching off a loop-\/region}

This is the partition function variant of \hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} \begin{DoxySeeAlso}{See also}
\hyperlink{group__loops_ga51f9851f3500c2aae66674142a6a2dd5}{E\+\_\+\+Stem()} 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function is threadsafe
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The Boltzmann weighted energy contribution of the branch off the loop 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!get\+\_\+gquad\+\_\+matrix@{get\+\_\+gquad\+\_\+matrix}}
\index{get\+\_\+gquad\+\_\+matrix@{get\+\_\+gquad\+\_\+matrix}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{get\+\_\+gquad\+\_\+matrix(short $\ast$\+S, vrna\+\_\+param\+\_\+t $\ast$\+P)}{get_gquad_matrix(short *S, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ get\+\_\+gquad\+\_\+matrix (
\begin{DoxyParamCaption}
\item[{short $\ast$}]{S, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga392e45c9615aa123737671603fa4203c}{}\label{group__loops_ga392e45c9615aa123737671603fa4203c}


{\ttfamily \#include $<$\hyperlink{gquad_8h}{Vienna\+R\+N\+A/gquad.\+h}$>$}



Get a triangular matrix prefilled with minimum free energy contributions of G-\/quadruplexes. 

At each position ij in the matrix, the minimum free energy of any G-\/quadruplex delimited by i and j is stored. If no G-\/quadruplex formation is possible, the matrix element is set to I\+NF. Access the elements in the matrix via matrix\mbox{[}indx\mbox{[}j\mbox{]}+i\mbox{]}. To get the integer array indx see get\+\_\+jindx().

\begin{DoxySeeAlso}{See also}
get\+\_\+jindx(), encode\+\_\+sequence()
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em S} & The encoded sequence \\
\hline
{\em P} & A pointer to the data structure containing the precomputed energy contributions \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the G-\/quadruplex contribution matrix 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!parse\+\_\+gquad@{parse\+\_\+gquad}}
\index{parse\+\_\+gquad@{parse\+\_\+gquad}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{parse\+\_\+gquad(const char $\ast$struc, int $\ast$\+L, int l[3])}{parse_gquad(const char *struc, int *L, int l[3])}}]{\setlength{\rightskip}{0pt plus 5cm}int parse\+\_\+gquad (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{struc, }
\item[{int $\ast$}]{L, }
\item[{int}]{l\mbox{[}3\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_gae41763215b9c64d2a7b67f0df8a28078}{}\label{group__loops_gae41763215b9c64d2a7b67f0df8a28078}


{\ttfamily \#include $<$\hyperlink{gquad_8h}{Vienna\+R\+N\+A/gquad.\+h}$>$}

given a dot-\/bracket structure (possibly) containing gquads encoded by \textquotesingle{}+\textquotesingle{} signs, find first gquad, return end position or 0 if none found Upon return L and l\mbox{[}\mbox{]} contain the number of stacked layers, as well as the lengths of the linker regions. To parse a string with many gquads, call parse\+\_\+gquad repeatedly e.\+g. end1 = parse\+\_\+gquad(struc, \&\+L, l); ... ; end2 = parse\+\_\+gquad(struc+end1, \&L, l); end2+=end1; ... ; end3 = parse\+\_\+gquad(struc+end2, \&L, l); end3+=end2; ... ; \index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop@{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop}}
\index{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop@{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop(int c, int i, int j, int type, short $\ast$\+S, int $\ast$ggg, int $\ast$index, int $\ast$p, int $\ast$q, vrna\+\_\+param\+\_\+t $\ast$\+P)}{backtrack_GQuad_IntLoop(int c, int i, int j, int type, short *S, int *ggg, int *index, int *p, int *q, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}P\+R\+I\+V\+A\+TE int backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop (
\begin{DoxyParamCaption}
\item[{int}]{c, }
\item[{int}]{i, }
\item[{int}]{j, }
\item[{int}]{type, }
\item[{short $\ast$}]{S, }
\item[{int $\ast$}]{ggg, }
\item[{int $\ast$}]{index, }
\item[{int $\ast$}]{p, }
\item[{int $\ast$}]{q, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga220c41e8dbcee940ac975b8ce88e55c5}{}\label{group__loops_ga220c41e8dbcee940ac975b8ce88e55c5}


{\ttfamily \#include $<$\hyperlink{gquad_8h}{Vienna\+R\+N\+A/gquad.\+h}$>$}

backtrack an interior loop like enclosed g-\/quadruplex with closing pair (i,j)


\begin{DoxyParams}{Parameters}
{\em c} & The total contribution the loop should resemble \\
\hline
{\em i} & position i of enclosing pair \\
\hline
{\em j} & position j of enclosing pair \\
\hline
{\em type} & base pair type of enclosing pair (must be reverse type) \\
\hline
{\em S} & integer encoded sequence \\
\hline
{\em ggg} & triangular matrix containing g-\/quadruplex contributions \\
\hline
{\em index} & the index for accessing the triangular matrix \\
\hline
{\em p} & here the 5\textquotesingle{} position of the gquad is stored \\
\hline
{\em q} & here the 3\textquotesingle{} position of the gquad is stored \\
\hline
{\em P} & the datastructure containing the precalculated contibutions\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 if no gquad found 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L@{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L}}
\index{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L@{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+\+L(int c, int i, int j, int type, short $\ast$\+S, int $\ast$$\ast$ggg, int maxdist, int $\ast$p, int $\ast$q, vrna\+\_\+param\+\_\+t $\ast$\+P)}{backtrack_GQuad_IntLoop_L(int c, int i, int j, int type, short *S, int **ggg, int maxdist, int *p, int *q, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}P\+R\+I\+V\+A\+TE int backtrack\+\_\+\+G\+Quad\+\_\+\+Int\+Loop\+\_\+L (
\begin{DoxyParamCaption}
\item[{int}]{c, }
\item[{int}]{i, }
\item[{int}]{j, }
\item[{int}]{type, }
\item[{short $\ast$}]{S, }
\item[{int $\ast$$\ast$}]{ggg, }
\item[{int}]{maxdist, }
\item[{int $\ast$}]{p, }
\item[{int $\ast$}]{q, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga7b371308fa5a45c7ac353ef6ed1014de}{}\label{group__loops_ga7b371308fa5a45c7ac353ef6ed1014de}


{\ttfamily \#include $<$\hyperlink{gquad_8h}{Vienna\+R\+N\+A/gquad.\+h}$>$}

backtrack an interior loop like enclosed g-\/quadruplex with closing pair (i,j) with underlying Lfold matrix


\begin{DoxyParams}{Parameters}
{\em c} & The total contribution the loop should resemble \\
\hline
{\em i} & position i of enclosing pair \\
\hline
{\em j} & position j of enclosing pair \\
\hline
{\em type} & base pair type of enclosing pair (must be reverse type) \\
\hline
{\em S} & integer encoded sequence \\
\hline
{\em ggg} & triangular matrix containing g-\/quadruplex contributions \\
\hline
{\em p} & here the 5\textquotesingle{} position of the gquad is stored \\
\hline
{\em q} & here the 3\textquotesingle{} position of the gquad is stored \\
\hline
{\em P} & the datastructure containing the precalculated contibutions\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 if no gquad found 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!E\+\_\+\+Hairpin@{E\+\_\+\+Hairpin}}
\index{E\+\_\+\+Hairpin@{E\+\_\+\+Hairpin}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{E\+\_\+\+Hairpin(int size, int type, int si1, int sj1, const char $\ast$string, vrna\+\_\+param\+\_\+t $\ast$\+P)}{E_Hairpin(int size, int type, int si1, int sj1, const char *string, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}P\+R\+I\+V\+A\+TE int E\+\_\+\+Hairpin (
\begin{DoxyParamCaption}
\item[{int}]{size, }
\item[{int}]{type, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{const char $\ast$}]{string, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_gadf943ee9a45b7f4cee9192c06210dace}{}\label{group__loops_gadf943ee9a45b7f4cee9192c06210dace}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



Compute the Energy of a hairpin-\/loop. 

To evaluate the free energy of a hairpin-\/loop, several parameters have to be known. A general hairpin-\/loop has this structure\+:~\newline
 
\begin{DoxyPre}
      a3 a4
    a2     a5
    a1     a6
      X - Y
      |   |
      5'  3'
\end{DoxyPre}
 where X-\/Y marks the closing pair \mbox{[}e.\+g. a {\bfseries (G,C)} pair\mbox{]}. The length of this loop is 6 as there are six unpaired nucleotides (a1-\/a6) enclosed by (X,Y). The 5\textquotesingle{} mismatching nucleotide is a1 while the 3\textquotesingle{} mismatch is a6. The nucleotide sequence of this loop is "a1.\+a2.\+a3.\+a4.\+a5.\+a6" ~\newline
 \begin{DoxyNote}{Note}
The parameter sequence should contain the sequence of the loop in capital letters of the nucleic acid alphabet if the loop size is below 7. This is useful for unusually stable tri-\/, tetra-\/ and hexa-\/loops which are treated differently (based on experimental data) if they are tabulated. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__energy__parameters_ga541f2cf7436e9bc939b0a49b24baf987}{scale\+\_\+parameters()} 

\hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} 
\end{DoxySeeAlso}
\begin{DoxyWarning}{Warning}
Not (really) thread safe! A threadsafe implementation will replace this function in a future release!~\newline
Energy evaluation may change due to updates in global variable \char`\"{}tetra\+\_\+loop\char`\"{}
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em size} & The size of the loop (number of unpaired nucleotides) \\
\hline
{\em type} & The pair type of the base pair closing the hairpin \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em string} & The sequence of the loop \\
\hline
{\em P} & The datastructure containing scaled energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Free energy of the Hairpin-\/loop in dcal/mol 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!exp\+\_\+\+E\+\_\+\+Hairpin@{exp\+\_\+\+E\+\_\+\+Hairpin}}
\index{exp\+\_\+\+E\+\_\+\+Hairpin@{exp\+\_\+\+E\+\_\+\+Hairpin}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{exp\+\_\+\+E\+\_\+\+Hairpin(int u, int type, short si1, short sj1, const char $\ast$string, vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$\+P)}{exp_E_Hairpin(int u, int type, short si1, short sj1, const char *string, vrna_exp_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}P\+R\+I\+V\+A\+TE {\bf F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+\+E\+\_\+\+Hairpin (
\begin{DoxyParamCaption}
\item[{int}]{u, }
\item[{int}]{type, }
\item[{short}]{si1, }
\item[{short}]{sj1, }
\item[{const char $\ast$}]{string, }
\item[{{\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga51fb555974f180b78d76142b2894851c}{}\label{group__loops_ga51fb555974f180b78d76142b2894851c}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



Compute Boltzmann weight $e^{-\Delta G/kT} $ of a hairpin loop. 

multiply by scale\mbox{[}u+2\mbox{]} \begin{DoxySeeAlso}{See also}
\hyperlink{group__energy__parameters_gabf3b9271c41dd3fac02d56e0b02b3344}{get\+\_\+scaled\+\_\+pf\+\_\+parameters()} 

\hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} 

\hyperlink{group__loops_gadf943ee9a45b7f4cee9192c06210dace}{E\+\_\+\+Hairpin()} 
\end{DoxySeeAlso}
\begin{DoxyWarning}{Warning}
Not (really) thread safe! A threadsafe implementation will replace this function in a future release!~\newline
Energy evaluation may change due to updates in global variable \char`\"{}tetra\+\_\+loop\char`\"{}
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em u} & The size of the loop (number of unpaired nucleotides) \\
\hline
{\em type} & The pair type of the base pair closing the hairpin \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide \\
\hline
{\em string} & The sequence of the loop \\
\hline
{\em P} & The datastructure containing scaled Boltzmann weights of the energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Boltzmann weight of the Hairpin-\/loop 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!vrna\+\_\+\+E\+\_\+hp\+\_\+loop@{vrna\+\_\+\+E\+\_\+hp\+\_\+loop}}
\index{vrna\+\_\+\+E\+\_\+hp\+\_\+loop@{vrna\+\_\+\+E\+\_\+hp\+\_\+loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{vrna\+\_\+\+E\+\_\+hp\+\_\+loop(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, int i, int j)}{vrna_E_hp_loop(vrna_fold_compound_t *vc, int i, int j)}}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\+\_\+\+E\+\_\+hp\+\_\+loop (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{int}]{i, }
\item[{int}]{j}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga999ba163a8148d72fd5f22819a681df7}{}\label{group__loops_ga999ba163a8148d72fd5f22819a681df7}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



Evaluate the free energy of a hairpin loop and consider hard constraints if they apply. 

This function evaluates the free energy of a hairpin loop

In case the base pair is not allowed due to a constraint conflict, this function returns \hyperlink{energy__const_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{I\+NF}.

\begin{DoxyNote}{Note}
This function is polymorphic! The provided \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} may be of type \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da1608d3aa78905fc39e0d25a624ac9512}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+I\+N\+G\+LE} or \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da056345f1bcfe7cd595d1fd437c05246d}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT}
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} that stores all relevant model settings \\
\hline
{\em i} & The 5\textquotesingle{} nucleotide of the base pair (3\textquotesingle{} to evaluate the pair as exterior hairpin loop) \\
\hline
{\em j} & The 3\textquotesingle{} nucleotide of the base pair (5\textquotesingle{} to evaluate the pair as exterior hairpin loop) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The free energy of the hairpin loop in 10cal/mol 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop@{vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop}}
\index{vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop@{vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, int i, int j)}{vrna_E_ext_hp_loop(vrna_fold_compound_t *vc, int i, int j)}}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\+\_\+\+E\+\_\+ext\+\_\+hp\+\_\+loop (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{int}]{i, }
\item[{int}]{j}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_gac3393ee309372eccae944e3a07f455f9}{}\label{group__loops_gac3393ee309372eccae944e3a07f455f9}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



Evaluate the free energy of an exterior hairpin loop and consider possible hard constraints. 

\begin{DoxyNote}{Note}
This function is polymorphic! The provided \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} may be of type \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da1608d3aa78905fc39e0d25a624ac9512}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+I\+N\+G\+LE} or \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da056345f1bcfe7cd595d1fd437c05246d}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} 
\end{DoxyNote}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop@{vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop}}
\index{vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop@{vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, int i, int j)}{vrna_exp_E_hp_loop(vrna_fold_compound_t *vc, int i, int j)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} vrna\+\_\+exp\+\_\+\+E\+\_\+hp\+\_\+loop (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{int}]{i, }
\item[{int}]{j}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_gac9f49b31d3ec1d9040798b05506c71da}{}\label{group__loops_gac9f49b31d3ec1d9040798b05506c71da}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



High-\/\+Level function for hairpin loop energy evaluation (partition function variant) 

\begin{DoxySeeAlso}{See also}
\hyperlink{group__loops_ga999ba163a8148d72fd5f22819a681df7}{vrna\+\_\+\+E\+\_\+hp\+\_\+loop()} for it\textquotesingle{}s free energy counterpart
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function is polymorphic! The provided \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} may be of type \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da1608d3aa78905fc39e0d25a624ac9512}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+I\+N\+G\+LE} or \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da056345f1bcfe7cd595d1fd437c05246d}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} 
\end{DoxyNote}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop@{vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop}}
\index{vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop@{vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, int i, int j, int en, vrna\+\_\+bp\+\_\+stack\+\_\+t $\ast$bp\+\_\+stack, int $\ast$stack\+\_\+count)}{vrna_BT_hp_loop(vrna_fold_compound_t *vc, int i, int j, int en, vrna_bp_stack_t *bp_stack, int *stack_count)}}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\+\_\+\+B\+T\+\_\+hp\+\_\+loop (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{int}]{i, }
\item[{int}]{j, }
\item[{int}]{en, }
\item[{{\bf vrna\+\_\+bp\+\_\+stack\+\_\+t} $\ast$}]{bp\+\_\+stack, }
\item[{int $\ast$}]{stack\+\_\+count}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga6c4ba14d24f716d0ca9021771357e903}{}\label{group__loops_ga6c4ba14d24f716d0ca9021771357e903}


{\ttfamily \#include $<$\hyperlink{hairpin__loops_8h}{Vienna\+R\+N\+A/hairpin\+\_\+loops.\+h}$>$}



Backtrack a hairpin loop closed by $ (i,j) $. 

\begin{DoxyNote}{Note}
This function is polymorphic! The provided \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} may be of type \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da1608d3aa78905fc39e0d25a624ac9512}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+I\+N\+G\+LE} or \hyperlink{group__fold__compound_gga01a4ff86fa71deaaa5d1abbd95a1447da056345f1bcfe7cd595d1fd437c05246d}{V\+R\+N\+A\+\_\+\+V\+C\+\_\+\+T\+Y\+P\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} 
\end{DoxyNote}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!E\+\_\+\+Int\+Loop@{E\+\_\+\+Int\+Loop}}
\index{E\+\_\+\+Int\+Loop@{E\+\_\+\+Int\+Loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{E\+\_\+\+Int\+Loop(int n1, int n2, int type, int type\+\_\+2, int si1, int sj1, int sp1, int sq1, vrna\+\_\+param\+\_\+t $\ast$\+P)}{E_IntLoop(int n1, int n2, int type, int type_2, int si1, int sj1, int sp1, int sq1, vrna_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}int E\+\_\+\+Int\+Loop (
\begin{DoxyParamCaption}
\item[{int}]{n1, }
\item[{int}]{n2, }
\item[{int}]{type, }
\item[{int}]{type\+\_\+2, }
\item[{int}]{si1, }
\item[{int}]{sj1, }
\item[{int}]{sp1, }
\item[{int}]{sq1, }
\item[{{\bf vrna\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga0266d2c7a6098259280fb97e9f980b34}{}\label{group__loops_ga0266d2c7a6098259280fb97e9f980b34}


{\ttfamily \#include $<$\hyperlink{interior__loops_8h}{Vienna\+R\+N\+A/interior\+\_\+loops.\+h}$>$}

\subsubsection*{Compute the Energy of an interior-\/loop}

This function computes the free energy $\Delta G$ of an interior-\/loop with the following structure\+: ~\newline
 
\begin{DoxyPre}
      3'  5'
      |   |
      U - V
  a\_n       b\_1
   .        .
   .        .
   .        .
  a\_1       b\_m
      X - Y
      |   |
      5'  3'
\end{DoxyPre}
 This general structure depicts an interior-\/loop that is closed by the base pair (X,Y). The enclosed base pair is (V,U) which leaves the unpaired bases a\+\_\+1-\/a\+\_\+n and b\+\_\+1-\/b\+\_\+n that constitute the loop. In this example, the length of the interior-\/loop is $(n+m)$ where n or m may be 0 resulting in a bulge-\/loop or base pair stack. The mismatching nucleotides for the closing pair (X,Y) are\+:~\newline
 5\textquotesingle{}-\/mismatch\+: a\+\_\+1~\newline
 3\textquotesingle{}-\/mismatch\+: b\+\_\+m~\newline
 and for the enclosed base pair (V,U)\+:~\newline
 5\textquotesingle{}-\/mismatch\+: b\+\_\+1~\newline
 3\textquotesingle{}-\/mismatch\+: a\+\_\+n~\newline
 \begin{DoxyNote}{Note}
Base pairs are always denoted in 5\textquotesingle{}-\/$>$3\textquotesingle{} direction. Thus the enclosed base pair must be \textquotesingle{}turned arround\textquotesingle{} when evaluating the free energy of the interior-\/loop 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__energy__parameters_ga541f2cf7436e9bc939b0a49b24baf987}{scale\+\_\+parameters()} 

\hyperlink{group__energy__parameters_ga8a69ca7d787e4fd6079914f5343a1f35}{vrna\+\_\+param\+\_\+t} 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function is threadsafe
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em n1} & The size of the \textquotesingle{}left\textquotesingle{}-\/loop (number of unpaired nucleotides) \\
\hline
{\em n2} & The size of the \textquotesingle{}right\textquotesingle{}-\/loop (number of unpaired nucleotides) \\
\hline
{\em type} & The pair type of the base pair closing the interior loop \\
\hline
{\em type\+\_\+2} & The pair type of the enclosed base pair \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide of the closing pair \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide of the closing pair \\
\hline
{\em sp1} & The 3\textquotesingle{}-\/mismatching nucleotide of the enclosed pair \\
\hline
{\em sq1} & The 5\textquotesingle{}-\/mismatching nucleotide of the enclosed pair \\
\hline
{\em P} & The datastructure containing scaled energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Free energy of the Interior-\/loop in dcal/mol 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!exp\+\_\+\+E\+\_\+\+Int\+Loop@{exp\+\_\+\+E\+\_\+\+Int\+Loop}}
\index{exp\+\_\+\+E\+\_\+\+Int\+Loop@{exp\+\_\+\+E\+\_\+\+Int\+Loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{exp\+\_\+\+E\+\_\+\+Int\+Loop(int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1, vrna\+\_\+exp\+\_\+param\+\_\+t $\ast$\+P)}{exp_E_IntLoop(int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1, vrna_exp_param_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+\+E\+\_\+\+Int\+Loop (
\begin{DoxyParamCaption}
\item[{int}]{u1, }
\item[{int}]{u2, }
\item[{int}]{type, }
\item[{int}]{type2, }
\item[{short}]{si1, }
\item[{short}]{sj1, }
\item[{short}]{sp1, }
\item[{short}]{sq1, }
\item[{{\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga19f10a6a02bbd07f4cd27b16ac928ea3}{}\label{group__loops_ga19f10a6a02bbd07f4cd27b16ac928ea3}


{\ttfamily \#include $<$\hyperlink{interior__loops_8h}{Vienna\+R\+N\+A/interior\+\_\+loops.\+h}$>$}

\subsubsection*{Compute Boltzmann weight $e^{-\Delta G/kT} $ of interior loop}

multiply by scale\mbox{[}u1+u2+2\mbox{]} for scaling \begin{DoxySeeAlso}{See also}
\hyperlink{group__energy__parameters_gabf3b9271c41dd3fac02d56e0b02b3344}{get\+\_\+scaled\+\_\+pf\+\_\+parameters()} 

\hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} 

\hyperlink{group__loops_ga0266d2c7a6098259280fb97e9f980b34}{E\+\_\+\+Int\+Loop()} 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function is threadsafe
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em u1} & The size of the \textquotesingle{}left\textquotesingle{}-\/loop (number of unpaired nucleotides) \\
\hline
{\em u2} & The size of the \textquotesingle{}right\textquotesingle{}-\/loop (number of unpaired nucleotides) \\
\hline
{\em type} & The pair type of the base pair closing the interior loop \\
\hline
{\em type2} & The pair type of the enclosed base pair \\
\hline
{\em si1} & The 5\textquotesingle{}-\/mismatching nucleotide of the closing pair \\
\hline
{\em sj1} & The 3\textquotesingle{}-\/mismatching nucleotide of the closing pair \\
\hline
{\em sp1} & The 3\textquotesingle{}-\/mismatching nucleotide of the enclosed pair \\
\hline
{\em sq1} & The 5\textquotesingle{}-\/mismatching nucleotide of the enclosed pair \\
\hline
{\em P} & The datastructure containing scaled Boltzmann weights of the energy parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Boltzmann weight of the Interior-\/loop 
\end{DoxyReturn}
\index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!E\+\_\+mb\+\_\+loop\+\_\+stack@{E\+\_\+mb\+\_\+loop\+\_\+stack}}
\index{E\+\_\+mb\+\_\+loop\+\_\+stack@{E\+\_\+mb\+\_\+loop\+\_\+stack}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{E\+\_\+mb\+\_\+loop\+\_\+stack(int i, int j, vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc)}{E_mb_loop_stack(int i, int j, vrna_fold_compound_t *vc)}}]{\setlength{\rightskip}{0pt plus 5cm}int E\+\_\+mb\+\_\+loop\+\_\+stack (
\begin{DoxyParamCaption}
\item[{int}]{i, }
\item[{int}]{j, }
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga81d73d23f480f84df8cfd0042c032503}{}\label{group__loops_ga81d73d23f480f84df8cfd0042c032503}


{\ttfamily \#include $<$\hyperlink{multibranch__loops_8h}{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h}$>$}



Evaluate energy of a multi branch helices stacking onto closing pair (i,j) 

Computes total free energy for coaxial stacking of (i.\+j) with (i+1.k) or (k+1.j-\/1) \index{Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}!vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop@{vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop}}
\index{vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop@{vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop}!Processing and Evaluating Decomposed Loops@{Processing and Evaluating Decomposed Loops}}
\subsubsection[{\texorpdfstring{vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop(vrna\+\_\+fold\+\_\+compound\+\_\+t $\ast$vc, int $\ast$i, int $\ast$j, int $\ast$k, int en, int $\ast$component1, int $\ast$component2)}{vrna_BT_mb_loop(vrna_fold_compound_t *vc, int *i, int *j, int *k, int en, int *component1, int *component2)}}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\+\_\+\+B\+T\+\_\+mb\+\_\+loop (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{int $\ast$}]{i, }
\item[{int $\ast$}]{j, }
\item[{int $\ast$}]{k, }
\item[{int}]{en, }
\item[{int $\ast$}]{component1, }
\item[{int $\ast$}]{component2}
\end{DoxyParamCaption}
)}\hypertarget{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{}\label{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}


{\ttfamily \#include $<$\hyperlink{multibranch__loops_8h}{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h}$>$}



Backtrack the decomposition of a multi branch loop closed by $ (i,j) $. 


\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} filled with all relevant data for backtracking \\
\hline
{\em i} & 5\textquotesingle{} position of base pair closing the loop (will be set to 5\textquotesingle{} position of leftmost decomposed block upon successful backtracking) \\
\hline
{\em j} & 3\textquotesingle{} position of base pair closing the loop (will be set to 3\textquotesingle{} position of rightmost decomposed block upon successful backtracking) \\
\hline
{\em k} & Split position that delimits leftmost from rightmost block, \mbox{[}i,k\mbox{]} and \mbox{[}k+1, j\mbox{]}, respectively. (Will be set upon successful backtracking) \\
\hline
{\em en} & The energy contribution of the substructure enclosed by $ (i,j) $ \\
\hline
{\em component1} & Type of leftmost block (1 = ML, 2 = C) \\
\hline
{\em component2} & Type of rightmost block (1 = ML, 2 = C) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1, if backtracking succeeded, 0 otherwise. 
\end{DoxyReturn}
